create view Gold.dim_product as

SELECT 
       ROW_NUMBER() OVER (ORDER BY pn.[prd_start_dt],pn.[cat_id] ) as product_key
      ,pn.[prd_id] as product_id
      ,pn.[cat_id] as product_number
      ,pn.[prd_nm] as product_name
	  ,pn.[prd_key] as category_id
	  ,pc.[cat] as category
	  ,pc.[subcat] as subcategory
      ,pc.[maintenance] as maintenance
      ,pn.[prd_cost] as product_cost
      ,pn.[prd_line] as product_line
      ,pn.[prd_start_dt] as product_start_date
      
	  FROM [Datawarehouse].[Silver].[crm_prd_info] pn

	  left join [Datawarehouse].[Silver].[erp_px_cat_g1v2] pc
	  ON pn.prd_key  = pc.id

	  WHERE prd_end_dt is null-- filter out all historical data

select * from Gold.dim_product 
